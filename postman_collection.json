{
  "info": {
    "name": "DattaPay API",
    "description": "API collection for DattaPay Server - User, Address, Zynk, Wallet, External Account, Teleport, and Passkey endpoints. All endpoints use authenticated user from JWT token.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:5000/api",
      "type": "string"
    },
    {
      "key": "adminToken",
      "value": "your-admin-api-token-here",
      "type": "string"
    },
    {
      "key": "authToken",
      "value": "your-clerk-jwt-token-here",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Users",
      "description": "User management endpoints - uses authenticated user from JWT",
      "item": [
        {
          "name": "Get All Users",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/users",
              "host": ["{{baseUrl}}"],
              "path": ["users"]
            },
            "description": "Retrieves all users from the database."
          }
        },
        {
          "name": "Get Current User",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/users/me",
              "host": ["{{baseUrl}}"],
              "path": ["users", "me"]
            },
            "description": "Retrieves the currently authenticated user."
          }
        },
        {
          "name": "Get Current User by Email",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/users/email",
              "host": ["{{baseUrl}}"],
              "path": ["users", "email"]
            },
            "description": "Retrieves the currently authenticated user by their email."
          }
        },
        {
          "name": "Create User",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"clerkUserId\": \"user_2xYz8KmNpQrStUvWx\",\n  \"firstName\": \"John\",\n  \"lastName\": \"Doe\",\n  \"email\": \"john.doe@email.com\",\n  \"phoneNumberPrefix\": \"1\",\n  \"phoneNumber\": \"4155551234\",\n  \"nationality\": \"US\",\n  \"dateOfBirth\": \"1990-05-15\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/users",
              "host": ["{{baseUrl}}"],
              "path": ["users"]
            },
            "description": "Creates a new user. Email is validated against Zynk to prevent duplicates."
          }
        },
        {
          "name": "Update Current User",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"firstName\": \"Johnny\",\n  \"phoneNumber\": \"4155559876\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/users/update-user",
              "host": ["{{baseUrl}}"],
              "path": ["users", "update-user"]
            },
            "description": "Updates the currently authenticated user."
          }
        },
        {
          "name": "Delete Current User",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/users/delete-user",
              "host": ["{{baseUrl}}"],
              "path": ["users", "delete-user"]
            },
            "description": "Deletes the currently authenticated user. Also deletes associated address."
          }
        }
      ]
    },
    {
      "name": "Addresses",
      "description": "Address management endpoints - uses authenticated user from JWT",
      "item": [
        {
          "name": "Get Current User's Address",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/addresses",
              "host": ["{{baseUrl}}"],
              "path": ["addresses"]
            },
            "description": "Retrieves the address for the currently authenticated user."
          }
        },
        {
          "name": "Create Address",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"addressLine1\": \"123 Main Street\",\n  \"addressLine2\": \"Apt 4B\",\n  \"locality\": \"Downtown\",\n  \"city\": \"San Francisco\",\n  \"state\": \"CA\",\n  \"country\": \"US\",\n  \"postalCode\": \"94102\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/addresses",
              "host": ["{{baseUrl}}"],
              "path": ["addresses"]
            },
            "description": "Creates a new address for the currently authenticated user. Each user can only have one address."
          }
        },
        {
          "name": "Update Current User's Address",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"addressLine1\": \"456 Oak Avenue\",\n  \"city\": \"Los Angeles\",\n  \"state\": \"CA\",\n  \"postalCode\": \"90001\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/addresses",
              "host": ["{{baseUrl}}"],
              "path": ["addresses"]
            },
            "description": "Updates the address for the currently authenticated user."
          }
        },
        {
          "name": "Delete Current User's Address",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/addresses",
              "host": ["{{baseUrl}}"],
              "path": ["addresses"]
            },
            "description": "Deletes the address for the currently authenticated user."
          }
        }
      ]
    },
    {
      "name": "Zynk",
      "description": "Zynk integration endpoints - uses authenticated user from JWT",
      "item": [
        {
          "name": "Create Zynk Entity",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/zynk/entities",
              "host": ["{{baseUrl}}"],
              "path": ["zynk", "entities"]
            },
            "description": "Creates a Zynk entity for the authenticated user. User must have an address and must not already have a Zynk entity."
          }
        },
        {
          "name": "Start KYC",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/zynk/kyc",
              "host": ["{{baseUrl}}"],
              "path": ["zynk", "kyc"]
            },
            "description": "Starts KYC verification for the authenticated user. User must have a Zynk entity. Returns kycLink, tosLink, and kycStatus."
          }
        },
        {
          "name": "Get KYC Status",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/zynk/kyc/status",
              "host": ["{{baseUrl}}"],
              "path": ["zynk", "kyc", "status"]
            },
            "description": "Gets KYC status for the authenticated user. Returns status array with routingId, supportedRoutes, kycStatus, routingEnabled, and kycFees."
          }
        },
        {
          "name": "Create Funding Account",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/zynk/funding-account",
              "host": ["{{baseUrl}}"],
              "path": ["zynk", "funding-account"]
            },
            "description": "Creates a funding account for the authenticated user. User must have a Zynk entity and must not already have a funding account."
          }
        },
        {
          "name": "Get Funding Account",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/zynk/funding-account",
              "host": ["{{baseUrl}}"],
              "path": ["zynk", "funding-account"]
            },
            "description": "Gets funding account details for the authenticated user. Returns bank account info including currency, bank name, routing number, account number, and payment rails."
          }
        },
        {
          "name": "Activate Funding Account",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/zynk/funding-account/activate",
              "host": ["{{baseUrl}}"],
              "path": ["zynk", "funding-account", "activate"]
            },
            "description": "Activates the funding account for the authenticated user. Returns funding account data with status set to 'active'."
          }
        },
        {
          "name": "Deactivate Funding Account",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/zynk/funding-account/deactivate",
              "host": ["{{baseUrl}}"],
              "path": ["zynk", "funding-account", "deactivate"]
            },
            "description": "Deactivates the funding account for the authenticated user. Returns funding account data with status set to 'inactive'."
          }
        }
      ]
    },
    {
      "name": "Wallets",
      "description": "Wallet management endpoints - uses authenticated user from JWT. Requires completed KYC.",
      "item": [
        {
          "name": "Initiate Session (Send OTP)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/wallets/session/initiate",
              "host": ["{{baseUrl}}"],
              "path": ["wallets", "session", "initiate"]
            },
            "description": "Initiates wallet session by sending OTP to user's registered email. User must have completed KYC. Returns otpId for verification."
          }
        },
        {
          "name": "Verify Session (Verify OTP)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"otpId\": \"otp_xxxxxxxxxxxxx\",\n  \"otpCode\": \"123456\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/wallets/session/verify",
              "host": ["{{baseUrl}}"],
              "path": ["wallets", "session", "verify"]
            },
            "description": "Verifies OTP and establishes session for wallet operations. Session is valid for 15 minutes. Returns sessionId and expiresAt."
          }
        },
        {
          "name": "Create Wallet",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"walletName\": \"My Wallet\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/wallets",
              "host": ["{{baseUrl}}"],
              "path": ["wallets"]
            },
            "description": "Creates a wallet for the authenticated user. Requires active session from OTP verification. walletName is optional (defaults to 'Primary Wallet'). If wallet already exists, returns existing wallet. Each user can only have one wallet."
          }
        },
        {
          "name": "Get Wallet",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/wallets",
              "host": ["{{baseUrl}}"],
              "path": ["wallets"]
            },
            "description": "Retrieves the wallet for the authenticated user including account details (address, chain, status). No OTP required."
          }
        },
        {
          "name": "Get Wallet Balances",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/wallets/balances",
              "host": ["{{baseUrl}}"],
              "path": ["wallets", "balances"]
            },
            "description": "Retrieves token balances for the user's wallet. Returns array of balances with tokenAddress, symbol, name, decimals, balance, and usdValue. No OTP required."
          }
        },
        {
          "name": "Get Wallet Transactions",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/wallets/transactions?limit=20&offset=0",
              "host": ["{{baseUrl}}"],
              "path": ["wallets", "transactions"],
              "query": [
                {
                  "key": "limit",
                  "value": "20",
                  "description": "Number of transactions to return (1-100, default: 20)"
                },
                {
                  "key": "offset",
                  "value": "0",
                  "description": "Number of transactions to skip (default: 0)"
                }
              ]
            },
            "description": "Retrieves transaction history for the user's wallet. Returns array of transactions with hash, type, status, timestamp, from, to, amount, tokenSymbol, and fee. Supports pagination with limit and offset. No OTP required."
          }
        }
      ]
    },
    {
      "name": "External Accounts",
      "description": "External account (blockchain wallet) management endpoints - uses authenticated user from JWT. Requires Zynk entity.",
      "item": [
        {
          "name": "Create External Account",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"walletAddress\": \"0x1234567890abcdef1234567890abcdef12345678\",\n  \"label\": \"My MetaMask Wallet\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/external-accounts",
              "host": ["{{baseUrl}}"],
              "path": ["external-accounts"]
            },
            "description": "Creates an external account (blockchain wallet) for the authenticated user. User must have a Zynk entity. The wallet is registered with Zynk API. walletAddress is required, label is optional."
          }
        },
        {
          "name": "List External Accounts",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/external-accounts",
              "host": ["{{baseUrl}}"],
              "path": ["external-accounts"]
            },
            "description": "Retrieves all external accounts for the authenticated user. Returns array of external accounts with id, walletAddress, label, status, and timestamps."
          }
        },
        {
          "name": "Get External Account by ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/external-accounts/1",
              "host": ["{{baseUrl}}"],
              "path": ["external-accounts", "1"]
            },
            "description": "Retrieves a specific external account by ID for the authenticated user. Returns 404 if not found or not owned by user."
          }
        },
        {
          "name": "Delete External Account",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/external-accounts/1",
              "host": ["{{baseUrl}}"],
              "path": ["external-accounts", "1"]
            },
            "description": "Deletes an external account by ID for the authenticated user. Also removes the account from Zynk. Returns 404 if not found or not owned by user."
          }
        }
      ]
    },
    {
      "name": "Teleport",
      "description": "Teleport management endpoints - links funding account to external account via Zynk. Requires Zynk entity and funding account.",
      "item": [
        {
          "name": "Create Teleport",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"externalAccountId\": 1\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/teleport",
              "host": ["{{baseUrl}}"],
              "path": ["teleport"]
            },
            "description": "Creates a teleport linking the user's funding account to an external account. User must have Zynk entity and funding account. Each user can only have one teleport."
          }
        },
        {
          "name": "Get Teleport",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/teleport",
              "host": ["{{baseUrl}}"],
              "path": ["teleport"]
            },
            "description": "Retrieves the teleport for the authenticated user. Returns teleport details including the linked external account."
          }
        },
        {
          "name": "Update Teleport",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"externalAccountId\": 2\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/teleport",
              "host": ["{{baseUrl}}"],
              "path": ["teleport"]
            },
            "description": "Updates the teleport destination by changing the external account. Creates a new teleport in Zynk with the new external account."
          }
        }
      ]
    },
    {
      "name": "Passkey",
      "description": "Passkey registration endpoints - registers passkey authenticator with Zynk. Requires Zynk entity.",
      "item": [
        {
          "name": "Register Passkey",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "x-api-token",
                "value": "{{adminToken}}",
                "type": "text"
              },
              {
                "key": "x-auth-token",
                "value": "{{authToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"publicKey\": \"your-public-key\",\n  \"privateKey\": \"your-private-key\",\n  \"passkeyData\": {\n    \"authenticatorName\": \"My Authenticator\",\n    \"challenge\": \"challenge-string\",\n    \"attestation\": {\n      \"credentialId\": \"credential-id\",\n      \"clientDataJson\": \"client-data-json\",\n      \"attestationObject\": \"attestation-object\",\n      \"transports\": [\"internal\"]\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/passkey",
              "host": ["{{baseUrl}}"],
              "path": ["passkey"]
            },
            "description": "Registers a passkey authenticator for the authenticated user. User must have a Zynk entity. Prepares and submits passkey registration to Zynk API."
          }
        }
      ]
    }
  ]
}
